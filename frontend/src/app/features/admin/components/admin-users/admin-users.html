<div class="page">
  <main class="main">
    <div class="container">
      <div class="header">
        <div>
          <h1 class="title">User Management</h1>
          <p class="subtitle">Search and manage user accounts</p>
        </div>
        <a matButton routerLink="/admin" class="backButton"
          ><mat-icon>arrow_backward</mat-icon> Back to Dashboard</a
        >
      </div>

      <mat-card class="searchBox">
        <!-- <input
          type="text"
          placeholder="Search by username or display name..."
          [value]="searchQuery()"
          (input)="searchQuery.set($any($event.target).value)"
          class="searchInput"
        /> -->

        <div class="search">
          <mat-icon matPrefix>search</mat-icon>
          <input type="text" placeholder="search.." />
          <!-- <span>Search for bloggers...</span> -->
        </div>
      </mat-card>

      <div class="tableWrapper">
        <table class="table">
          <thead>
            <tr>
              <th>User</th>
              <th>Posts</th>
              <th>Subscribers</th>
              <th>Joined</th>
              <th>Role</th>
              <th>Status</th>
            </tr>
          </thead>

          <tbody>
            <tr *ngFor="let user of users" [class.bannedRow]="user.status === 'banned'">
              <td class="userCell">
                <div class="userRow">
                  <div>
                    <div class="userName authorName" (click)="openUserCardDialog(user.username)">
                      {{ user.name }}
                    </div>
                    <div
                      class="userUsername authorName"
                      (click)="openUserCardDialog(user.username)"
                    >
                      @{{ user.username }}
                    </div>
                  </div>
                </div>
              </td>

              <td>{{ user.postsCount }}</td>
              <td>{{ user.subscribersCount }}</td>
              <td>
                <span class="createdAt">{{ user.createdAt | date : 'medium' }}</span>
              </td>

              <td>
                <span
                  class="roleBadge"
                  [class.adminRole]="user.role == 'ADMIN'"
                  [class.userRole]="user.role == 'USER'"
                >
                  {{ user.role.toLocaleLowerCase() }}
                </span>
              </td>

              <td>
                <span
                  class="statusBadge"
                  [class.banned]="user.status === 'BANNED'"
                  [class.active]="user.status === 'ACTIVE'"
                >
                  {{ user.status.toLocaleLowerCase() }}
                </span>
              </td>
            </tr>
            @if (isLoading) {
            <tr>
              <td [colSpan]="6" class="spinnerContainer">
                <app-spinner></app-spinner>
              </td>
            </tr>
            }
          </tbody>
        </table>
      </div>

      <div *ngIf="users.length === 0" class="emptyState">No users found matching your search</div>
    </div>
  </main>
</div>
