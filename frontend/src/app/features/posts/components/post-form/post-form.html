<div class="modalOverlay" (click)="onClose()">
  <mat-card class="modalContent" (click)="stopPropagation($event)">
    <div class="modalHeader">
      <h2 class="modalTitle">
        <mat-icon color="primary">edit_note</mat-icon> Craft Your Post
      </h2>
      <button mat-icon-button (click)="onClose()">
        <mat-icon>close</mat-icon>
      </button>
    </div>

    <div class="modalBody">
      <!-- Title -->
      <mat-form-field appearance="fill" class="w-full">
        <label><mat-icon class="labelIcon">title</mat-icon> Title</label>
        <input matInput [(ngModel)]="title" maxlength="{{ maxTitleChars }}" placeholder="Enter your post title..." />
        <mat-hint align="end">{{ title.length }}/{{ maxTitleChars }}</mat-hint>
      </mat-form-field>

      <!-- Body -->
      <mat-form-field appearance="fill" class="w-full">
        <label><mat-icon class="labelIcon">description</mat-icon> Content</label>
        <textarea matInput [(ngModel)]="body" rows="5" maxlength="{{ maxBodyChars }}"
          placeholder="Share your thoughts..."></textarea>
        <mat-hint align="end">{{ body.length }}/{{ maxBodyChars }}</mat-hint>
      </mat-form-field>

      <!-- Media Upload -->
      <div class="mediaUpload">
        <label class="uploadLabel">
          <mat-icon class="labelIcon" style="margin: 0;">perm_media</mat-icon> Media (up to {{ maxMediaCount }})
        </label>

        <label class="uploadButton" *ngIf="mediaFiles.length < maxMediaCount">
          <mat-icon>cloud_upload</mat-icon>
          <span>Upload images or videos</span>
          <input type="file" accept="image/*,video/*" multiple (change)="handleMediaUpload($event)" hidden />
        </label>

        <app-media-grid [mediaFiles]="mediaFiles" (remove)="removeMedia($event)"></app-media-grid>
      </div>
    </div>

    <div class="modalFooter">
      <button mat-stroked-button color="warn" (click)="onClose()">
        <mat-icon>cancel</mat-icon> Cancel
      </button>
      <button mat-flat-button color="primary" (click)="handleSubmit()" [disabled]="!title.trim() || !body.trim()">
        <mat-icon>publish</mat-icon> Publish
      </button>
    </div>
  </mat-card>
</div>
